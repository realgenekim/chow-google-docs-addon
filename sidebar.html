<!DOCTYPE html>
<html>
  <head>
    <script>
      function onButtonClick() {
        google.script.run.showAlert();
      }
      
      function getSelection() {
        google.script.run
          .withSuccessHandler(function(text) {
            document.getElementById('selected-text').innerHTML = text;
          })
          .getSelectedText();
      }

      function loadDeploymentVersion() {
        google.script.run
          .withSuccessHandler(function(version) {
            document.getElementById('deployment-version').innerHTML = 'Deployment Version: ' + version;
          })
          .getDeploymentVersion();
      }

      // Load version when sidebar opens
      loadDeploymentVersion();
    </script>
  </head>
  <body>
    <h3>Welcome to My Add-on</h3>
    <div id="deployment-version" style="color: #666; margin-bottom: 10px;"></div>
    <p>This is a sidebar with a button.  TTTT </p>
    <button onclick="onButtonClick()">Click Me</button>
    <br><br>
    <button onclick="getSelection()">Get Selection</button>
    <div id="selected-text" style="margin-top: 10px; white-space: pre-wrap;"></div>
  </body>
</html>
<script>
  function onButtonClick() {
    google.script.run.showAlert();
  }
</script>
